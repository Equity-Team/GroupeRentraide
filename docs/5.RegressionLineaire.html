<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.21">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>7&nbsp; Regression Lineaire – Initiation à R dans le cadre d'une recherche épidémiologique</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./6.RegressionLogistique.html" rel="next">
<link href="./4.PremieresAnalyses.sur.R.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-ea1d7ac60288e0f1efdbc993fd8432ae.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-70a47bd5681a7291082a5b9f83d58762.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./5.RegressionLineaire.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression Lineaire</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header sidebar-header-stacked">
      <a href="./index.html" class="sidebar-logo-link">
      </a>
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Initiation à R dans le cadre d’une recherche épidémiologique</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Preface</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./0.Quelquesbases.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Quelques Bases</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./1.ManipulationTableaux.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Manipulation Tableaux</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./2.InitiationGraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Initiation Graphiques</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./3.PersonalisationGraphiques.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Personnalisation graphiques avec ggplot2</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./4.PremieresAnalyses.sur.R.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Analyses Bivariées</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./5.RegressionLineaire.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression Lineaire</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./6.RegressionLogistique.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression Logistique</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./7.RegressionMultinomialeOrdinale.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Régressions multinomiales et ordinales</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./8.Initiation_Fonctions_Boucles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Fonctions, conditions et boucles</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#import-des-données" id="toc-import-des-données" class="nav-link active" data-scroll-target="#import-des-données"><span class="header-section-number">7.1</span> Import des données</a></li>
  <li><a href="#régression-linéaire" id="toc-régression-linéaire" class="nav-link" data-scroll-target="#régression-linéaire"><span class="header-section-number">7.2</span> Régression linéaire</a>
  <ul class="collapse">
  <li><a href="#extraction-des-données-de-la-régression" id="toc-extraction-des-données-de-la-régression" class="nav-link" data-scroll-target="#extraction-des-données-de-la-régression"><span class="header-section-number">7.2.1</span> Extraction des données de la régression</a></li>
  <li><a href="#données-manquantes" id="toc-données-manquantes" class="nav-link" data-scroll-target="#données-manquantes"><span class="header-section-number">7.2.2</span> Données manquantes</a></li>
  <li><a href="#visualisation-graphique-des-coefficients" id="toc-visualisation-graphique-des-coefficients" class="nav-link" data-scroll-target="#visualisation-graphique-des-coefficients"><span class="header-section-number">7.2.3</span> Visualisation graphique des coefficients</a></li>
  <li><a href="#modèles-emboités" id="toc-modèles-emboités" class="nav-link" data-scroll-target="#modèles-emboités"><span class="header-section-number">7.2.4</span> Modèles emboités</a></li>
  <li><a href="#qualité-de-la-régression" id="toc-qualité-de-la-régression" class="nav-link" data-scroll-target="#qualité-de-la-régression"><span class="header-section-number">7.2.5</span> Qualité de la régression</a></li>
  <li><a href="#vérification-des-hypothèses" id="toc-vérification-des-hypothèses" class="nav-link" data-scroll-target="#vérification-des-hypothèses"><span class="header-section-number">7.2.6</span> Vérification des hypothèses</a></li>
  </ul></li>
  <li><a href="#ressources" id="toc-ressources" class="nav-link" data-scroll-target="#ressources"><span class="header-section-number">7.3</span> Ressources</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Regression Lineaire</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtsummary)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(olsrr) <span class="co"># pour les diagnostics de régression</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<section id="import-des-données" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="import-des-données"><span class="header-section-number">7.1</span> Import des données</h2>
<p>Pour cette séance, nous allons utiliser le jeu de données <em>NHANES</em> disponible dans le package du même nom.<br> <br> Il s’agit de données de santé provenant de l’enquête américaine <a href="https://wwwn.cdc.gov/nchs/nhanes/"><em>National Health and Nutrition Examination Survey (NHANES)</em></a>. Il contient des données sociale, comportementales et de santé. <br> <br> Une description des données est disponible dans le descriptif du package <a href="https://cran.r-project.org/web/packages/NHANES/NHANES.pdf">lien</a></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(NHANES)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(<span class="st">"NHANES"</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(NHANES)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10000    76</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">#kable(head(NHANES))</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<p>Dans ces données il semble y avoir des doublons. Nous allons les supprimer en utilisant la fonction <em>distinct()</em> de <em>dplyr</em>. Cette fonction ne garde qu’une ligne pour un groupe de lignes qui sont absolument identiques</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>NHANES <span class="ot">&lt;-</span> NHANES <span class="sc">%&gt;%</span> <span class="fu">distinct</span>()</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(NHANES)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7832   76</code></pre>
</div>
</div>
<p>Nous sommes passés de 10000 à 7155 observations <br> <br></p>
<p>Résumé des données</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(NHANES)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID           SurveyYr       Gender          Age          AgeDecade   
 Min.   :51624   2009_10:3568   female:3943   Min.   : 0.00    0-9   :1212  
 1st Qu.:57388   2011_12:4264   male  :3889   1st Qu.:16.00    10-19 :1142  
 Median :62914                                Median :35.00    30-39 :1038  
 Mean   :62369                                Mean   :35.97    20-29 :1023  
 3rd Qu.:67408                                3rd Qu.:54.00    40-49 :1010  
 Max.   :71915                                Max.   :80.00   (Other):2124  
                                                              NA's   : 283  
   AgeMonths          Race1           Race3               Education   
 Min.   :  0.0   Black   :1073   Asian   : 281   8th Grade     : 397  
 1st Qu.:169.0   Hispanic: 538   Black   : 563   9 - 11th Grade: 712  
 Median :387.0   Mexican : 920   Hispanic: 317   High School   :1131  
 Mean   :403.1   White   :4626   Mexican : 451   Some College  :1695  
 3rd Qu.:615.0   Other   : 675   White   :2510   College Grad  :1534  
 Max.   :959.0                   Other   : 142   NA's          :2363  
 NA's   :4271                    NA's    :3568                        
      MaritalStatus         HHIncome     HHIncomeMid        Poverty     
 Divorced    : 516   more 99999 :1588   Min.   :  2500   Min.   :0.000  
 LivePartner : 438   75000-99999: 809   1st Qu.: 22500   1st Qu.:1.130  
 Married     :2940   25000-34999: 784   Median : 50000   Median :2.400  
 NeverMarried:1048   35000-44999: 691   Mean   : 54862   Mean   :2.664  
 Separated   : 148   45000-54999: 596   3rd Qu.: 87500   3rd Qu.:4.500  
 Widowed     : 384   (Other)    :2711   Max.   :100000   Max.   :5.000  
 NA's        :2358   NA's       : 653   NA's   :653      NA's   :578    
   HomeRooms       HomeOwn             Work          Weight      
 Min.   : 1.000   Own  :4845   Looking   : 244   Min.   :  2.80  
 1st Qu.: 5.000   Rent :2753   NotWorking:2290   1st Qu.: 54.35  
 Median : 6.000   Other: 184   Working   :3376   Median : 71.60  
 Mean   : 6.173   NA's :  50   NA's      :1922   Mean   : 69.67  
 3rd Qu.: 7.000                                  3rd Qu.: 87.90  
 Max.   :13.000                                  Max.   :230.70  
 NA's   :54                                      NA's   :61      
     Length          HeadCirc         Height           BMI       
 Min.   : 47.10   Min.   :34.20   Min.   : 83.6   Min.   :12.88  
 1st Qu.: 75.15   1st Qu.:39.50   1st Qu.:155.8   1st Qu.:21.40  
 Median : 87.05   Median :41.30   Median :165.4   Median :25.83  
 Mean   : 84.89   Mean   :41.10   Mean   :160.9   Mean   :26.52  
 3rd Qu.: 95.80   3rd Qu.:42.98   3rd Qu.:173.9   3rd Qu.:30.64  
 Max.   :112.20   Max.   :45.40   Max.   :200.4   Max.   :81.25  
 NA's   :7334     NA's   :7750    NA's   :317     NA's   :327    
    BMICatUnder20yrs         BMI_WHO         Pulse           BPSysAve    
 UnderWeight:  47    12.0_18.5   :1070   Min.   : 40.00   Min.   : 76.0  
 NormWeight : 709    18.5_to_24.9:2261   1st Qu.: 66.00   1st Qu.:106.0  
 OverWeight : 180    25.0_to_29.9:2067   Median : 72.00   Median :116.0  
 Obese      : 197    30.0_plus   :2081   Mean   : 73.58   Mean   :118.1  
 NA's       :6699    NA's        : 353   3rd Qu.: 82.00   3rd Qu.:127.0  
                                         Max.   :136.00   Max.   :226.0  
                                         NA's   :1236     NA's   :1246   
    BPDiaAve          BPSys1         BPDia1          BPSys2     
 Min.   :  0.00   Min.   : 72    Min.   :  0.0   Min.   : 76.0  
 1st Qu.: 60.00   1st Qu.:106    1st Qu.: 60.0   1st Qu.:106.0  
 Median : 68.00   Median :116    Median : 68.0   Median :116.0  
 Mean   : 67.03   Mean   :119    Mean   : 67.9   Mean   :118.4  
 3rd Qu.: 76.00   3rd Qu.:128    3rd Qu.: 76.0   3rd Qu.:128.0  
 Max.   :116.00   Max.   :232    Max.   :118.0   Max.   :226.0  
 NA's   :1246     NA's   :1497   NA's   :1497    NA's   :1404   
     BPDia2           BPSys3          BPDia3        Testosterone    
 Min.   :  0.00   Min.   : 76.0   Min.   :  0.00   Min.   :   0.25  
 1st Qu.: 60.00   1st Qu.:106.0   1st Qu.: 60.00   1st Qu.:  17.53  
 Median : 68.00   Median :116.0   Median : 68.00   Median :  40.69  
 Mean   : 67.19   Mean   :117.9   Mean   : 66.83   Mean   : 193.72  
 3rd Qu.: 76.00   3rd Qu.:126.0   3rd Qu.: 76.00   3rd Qu.: 352.32  
 Max.   :118.00   Max.   :226.0   Max.   :116.00   Max.   :1795.60  
 NA's   :1404     NA's   :1400    NA's   :1400     NA's   :4354     
   DirectChol       TotChol         UrineVol1       UrineFlow1     
 Min.   :0.390   Min.   : 1.530   Min.   :  0.0   Min.   : 0.0000  
 1st Qu.:1.090   1st Qu.: 4.060   1st Qu.: 49.0   1st Qu.: 0.3970  
 Median :1.290   Median : 4.730   Median : 92.0   Median : 0.6820  
 Mean   :1.359   Mean   : 4.841   Mean   :117.1   Mean   : 0.9649  
 3rd Qu.:1.580   3rd Qu.: 5.480   3rd Qu.:162.0   3rd Qu.: 1.2130  
 Max.   :4.030   Max.   :13.650   Max.   :510.0   Max.   :17.1670  
 NA's   :1296    NA's   :1296     NA's   :865     NA's   :1340     
   UrineVol2       UrineFlow2     Diabetes     DiabetesAge        HealthGen   
 Min.   :  0.0   Min.   : 0.000   No  :7077   Min.   : 1.00   Excellent: 661  
 1st Qu.: 50.0   1st Qu.: 0.482   Yes : 622   1st Qu.:40.00   Vgood    :1848  
 Median : 92.5   Median : 0.765   NA's: 133   Median :50.00   Good     :2272  
 Mean   :119.5   Mean   : 1.154               Mean   :49.07   Fair     : 829  
 3rd Qu.:171.8   3rd Qu.: 1.507               3rd Qu.:60.00   Poor     : 155  
 Max.   :409.0   Max.   :13.692               Max.   :80.00   NA's     :2067  
 NA's   :6670    NA's   :6671                 NA's   :7315                    
 DaysPhysHlthBad  DaysMentHlthBad  LittleInterest   Depressed   
 Min.   : 0.000   Min.   : 0.000   None   :3837   None   :3937  
 1st Qu.: 0.000   1st Qu.: 0.000   Several: 869   Several: 783  
 Median : 0.000   Median : 0.000   Most   : 343   Most   : 331  
 Mean   : 3.423   Mean   : 4.112   NA's   :2783   NA's   :2781  
 3rd Qu.: 3.000   3rd Qu.: 4.000                                
 Max.   :30.000   Max.   :30.000                                
 NA's   :2074     NA's   :2072                                  
  nPregnancies       nBabies         Age1stBaby    SleepHrsNight   
 Min.   : 1.000   Min.   : 0.000   Min.   :14.00   Min.   : 2.000  
 1st Qu.: 2.000   1st Qu.: 2.000   1st Qu.:19.00   1st Qu.: 6.000  
 Median : 3.000   Median : 2.000   Median :22.00   Median : 7.000  
 Mean   : 3.087   Mean   : 2.503   Mean   :22.48   Mean   : 6.904  
 3rd Qu.: 4.000   3rd Qu.: 3.000   3rd Qu.:25.00   3rd Qu.: 8.000  
 Max.   :32.000   Max.   :12.000   Max.   :39.00   Max.   :12.000  
 NA's   :5840     NA's   :5986     NA's   :6375    NA's   :1935    
 SleepTrouble PhysActive  PhysActiveDays       TVHrsDay        CompHrsDay  
 No  :4430    No  :2853   Min.   :1.000   2_hr     :1082   0_to_1_hr:1194  
 Yes :1481    Yes :3521   1st Qu.:2.000   1_hr     : 741   0_hrs    : 953  
 NA's:1921    NA's:1458   Median :3.000   3_hr     : 727   1_hr     : 844  
                          Mean   :3.753   0_to_1_hr: 526   2_hr     : 491  
                          3rd Qu.:5.000   More_4_hr: 524   3_hr     : 298  
                          Max.   :7.000   (Other)  : 528   (Other)  : 352  
                          NA's   :4019    NA's     :3704   NA's     :3700  
 TVHrsDayChild   CompHrsDayChild Alcohol12PlusYr   AlcoholDay    
 Min.   :0.000   Min.   :0.000   No  :1087       Min.   : 1.000  
 1st Qu.:1.000   1st Qu.:0.000   Yes :3892       1st Qu.: 1.000  
 Median :2.000   Median :1.000   NA's:2853       Median : 2.000  
 Mean   :1.979   Mean   :2.255                   Mean   : 2.947  
 3rd Qu.:3.000   3rd Qu.:6.000                   3rd Qu.: 3.000  
 Max.   :6.000   Max.   :6.000                   Max.   :82.000  
 NA's   :7298    NA's   :7298                    NA's   :4160    
  AlcoholYear     SmokeNow    Smoke100         Smoke100n       SmokeAge    
 Min.   :  0.00   No  :1307   No  :3055   Non-Smoker:3055   Min.   : 6.00  
 1st Qu.:  3.00   Yes :1116   Yes :2423   Smoker    :2423   1st Qu.:15.00  
 Median : 24.00   NA's:5409   NA's:2354   NA's      :2354   Median :17.00  
 Mean   : 73.33                                             Mean   :17.75  
 3rd Qu.:104.00                                             3rd Qu.:19.00  
 Max.   :364.00                                             Max.   :72.00  
 NA's   :3388                                               NA's   :5507   
 Marijuana   AgeFirstMarij   RegularMarij  AgeRegMarij    HardDrugs  
 No  :1573   Min.   : 1.00   No  :2679    Min.   : 5.00   No  :3547  
 Yes :2096   1st Qu.:15.00   Yes : 990    1st Qu.:15.00   Yes : 764  
 NA's:4163   Median :16.00   NA's:4163    Median :17.00   NA's:3521  
             Mean   :17.02                Mean   :17.65              
             3rd Qu.:18.00                3rd Qu.:19.00              
             Max.   :48.00                Max.   :52.00              
             NA's   :5737                 NA's   :6842               
 SexEver         SexAge      SexNumPartnLife  SexNumPartYear   SameSex    
 No  : 175   Min.   : 9.00   Min.   :   0.0   Min.   : 0.000   No  :4000  
 Yes :4137   1st Qu.:15.00   1st Qu.:   2.0   1st Qu.: 1.000   Yes : 312  
 NA's:3520   Median :17.00   Median :   5.0   Median : 1.000   NA's:3520  
             Mean   :17.41   Mean   :  15.4   Mean   : 1.327              
             3rd Qu.:19.00   3rd Qu.:  12.0   3rd Qu.: 1.000              
             Max.   :50.00   Max.   :2000.0   Max.   :69.000              
             NA's   :3699    NA's   :3552     NA's   :4172                
      SexOrientation  PregnantNow  
 Bisexual    :  91   Yes    :  54  
 Heterosexual:3426   No     :1197  
 Homosexual  :  70   Unknown:  41  
 NA's        :4245   NA's   :6540  
                                   
                                   
                                   </code></pre>
</div>
</div>
</section>
<section id="régression-linéaire" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="régression-linéaire"><span class="header-section-number">7.2</span> Régression linéaire</h2>
<p>Pour modéliser / étudier une variable continue en fonction d’une ou plusieurs autres variables, on peut réaliser une régression linéaire. <br> <br> <em>Rappel : </em> Les hypothèses de la régression linéaire sont : <br> - Linéarité de la relation entre la variable expliquée et la variable explicative <br> - Abscence de colinéarité des variables explicatives <br> - Variance constante des résidus (homoscédasticité) <br> - Normalité des résidus <br> - Indépendance des résidus <br> - Nullité de l’espérance des résidus (validée par construction) <br></p>
<p><br> Pour réaliser une régression linéaire en R, on utilise la fonction <em>lm()</em>. Elle su’utilise de la façon suivante : <br> <span class="math display">\[lm(\text{outcome_var } \sim \text{ } x1+x2+x3\text{,  data} = \text{dataset_name})\]</span> <br> Pour obtenir une sortie avec les informations principales de la régrression on utilise la fonction <em>summary()</em><br> <br> Par exemple, nous pouvons modéliser par une régression linéaire le lien entre l’IMC et l’âge, le sexe, l’ethnicité, le niveau d’éducation et le statut marital</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>reg <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Race1 <span class="sc">+</span> Education <span class="sc">+</span> MaritalStatus, <span class="at">data =</span> NHANES)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMI ~ Gender + Age + Race1 + Education + MaritalStatus, 
    data = NHANES)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.567  -4.535  -1.072   3.191  52.375 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               31.246189   0.649866  48.081  &lt; 2e-16 ***
Gendermale                -0.203258   0.182953  -1.111  0.26662    
Age                        0.013282   0.006441   2.062  0.03923 *  
Race1Hispanic             -1.727673   0.435659  -3.966 7.41e-05 ***
Race1Mexican              -1.026818   0.399309  -2.571  0.01015 *  
Race1White                -2.185602   0.278198  -7.856 4.74e-15 ***
Race1Other                -3.984048   0.407448  -9.778  &lt; 2e-16 ***
Education9 - 11th Grade   -0.197181   0.430566  -0.458  0.64700    
EducationHigh School       0.009719   0.411282   0.024  0.98115    
EducationSome College     -0.046028   0.400777  -0.115  0.90857    
EducationCollege Grad     -1.330056   0.408946  -3.252  0.00115 ** 
MaritalStatusLivePartner  -1.177454   0.442981  -2.658  0.00788 ** 
MaritalStatusMarried      -0.515094   0.320489  -1.607  0.10807    
MaritalStatusNeverMarried -1.044403   0.377927  -2.764  0.00574 ** 
MaritalStatusSeparated     0.007168   0.623717   0.011  0.99083    
MaritalStatusWidowed      -0.891085   0.469306  -1.899  0.05765 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.602 on 5400 degrees of freedom
  (2416 observations deleted due to missingness)
Multiple R-squared:  0.03659,   Adjusted R-squared:  0.03392 
F-statistic: 13.67 on 15 and 5400 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>On peut exporter les coefficients dans un tableau avec la fonction <em>tbl_regression()</em> du package <em>GTsummary</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tbl_regression</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div id="pfqntdbpmj" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#pfqntdbpmj table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#pfqntdbpmj thead, #pfqntdbpmj tbody, #pfqntdbpmj tfoot, #pfqntdbpmj tr, #pfqntdbpmj td, #pfqntdbpmj th {
  border-style: none;
}

#pfqntdbpmj p {
  margin: 0;
  padding: 0;
}

#pfqntdbpmj .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#pfqntdbpmj .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#pfqntdbpmj .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#pfqntdbpmj .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#pfqntdbpmj .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pfqntdbpmj .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfqntdbpmj .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#pfqntdbpmj .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#pfqntdbpmj .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#pfqntdbpmj .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#pfqntdbpmj .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#pfqntdbpmj .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#pfqntdbpmj .gt_spanner_row {
  border-bottom-style: hidden;
}

#pfqntdbpmj .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#pfqntdbpmj .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#pfqntdbpmj .gt_from_md > :first-child {
  margin-top: 0;
}

#pfqntdbpmj .gt_from_md > :last-child {
  margin-bottom: 0;
}

#pfqntdbpmj .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#pfqntdbpmj .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#pfqntdbpmj .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#pfqntdbpmj .gt_row_group_first td {
  border-top-width: 2px;
}

#pfqntdbpmj .gt_row_group_first th {
  border-top-width: 2px;
}

#pfqntdbpmj .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfqntdbpmj .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#pfqntdbpmj .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#pfqntdbpmj .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfqntdbpmj .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfqntdbpmj .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#pfqntdbpmj .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#pfqntdbpmj .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#pfqntdbpmj .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#pfqntdbpmj .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pfqntdbpmj .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfqntdbpmj .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#pfqntdbpmj .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#pfqntdbpmj .gt_left {
  text-align: left;
}

#pfqntdbpmj .gt_center {
  text-align: center;
}

#pfqntdbpmj .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#pfqntdbpmj .gt_font_normal {
  font-weight: normal;
}

#pfqntdbpmj .gt_font_bold {
  font-weight: bold;
}

#pfqntdbpmj .gt_font_italic {
  font-style: italic;
}

#pfqntdbpmj .gt_super {
  font-size: 65%;
}

#pfqntdbpmj .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#pfqntdbpmj .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#pfqntdbpmj .gt_indent_1 {
  text-indent: 5px;
}

#pfqntdbpmj .gt_indent_2 {
  text-indent: 10px;
}

#pfqntdbpmj .gt_indent_3 {
  text-indent: 15px;
}

#pfqntdbpmj .gt_indent_4 {
  text-indent: 20px;
}

#pfqntdbpmj .gt_indent_5 {
  text-indent: 25px;
}

#pfqntdbpmj .katex-display {
  display: inline-flex !important;
  margin-bottom: 0.75em !important;
}

#pfqntdbpmj div.Reactable > div.rt-table > div.rt-thead > div.rt-tr.rt-tr-group-header > div.rt-th-group:after {
  height: 0px !important;
}
</style>

<table class="gt_table caption-top table table-sm table-striped small" data-quarto-bootstrap="false">
<colgroup>
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
<col style="width: 25%">
</colgroup>
<thead>
<tr class="gt_col_headings header">
<th id="label" class="gt_col_heading gt_columns_bottom_border gt_left" data-quarto-table-cell-role="th" scope="col"><strong>Characteristic</strong></th>
<th id="estimate" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>Beta</strong></th>
<th id="conf.low" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>95% CI</strong></th>
<th id="p.value" class="gt_col_heading gt_columns_bottom_border gt_center" data-quarto-table-cell-role="th" scope="col"><strong>p-value</strong></th>
</tr>
</thead>
<tbody class="gt_table_body">
<tr class="odd">
<td class="gt_row gt_left" headers="label">Gender</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;female</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;male</td>
<td class="gt_row gt_center" headers="estimate">-0.20</td>
<td class="gt_row gt_center" headers="conf.low">-0.56, 0.16</td>
<td class="gt_row gt_center" headers="p.value">0.3</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">Age</td>
<td class="gt_row gt_center" headers="estimate">0.01</td>
<td class="gt_row gt_center" headers="conf.low">0.00, 0.03</td>
<td class="gt_row gt_center" headers="p.value">0.039</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Race1</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Black</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Hispanic</td>
<td class="gt_row gt_center" headers="estimate">-1.7</td>
<td class="gt_row gt_center" headers="conf.low">-2.6, -0.87</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Mexican</td>
<td class="gt_row gt_center" headers="estimate">-1.0</td>
<td class="gt_row gt_center" headers="conf.low">-1.8, -0.24</td>
<td class="gt_row gt_center" headers="p.value">0.010</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;White</td>
<td class="gt_row gt_center" headers="estimate">-2.2</td>
<td class="gt_row gt_center" headers="conf.low">-2.7, -1.6</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Other</td>
<td class="gt_row gt_center" headers="estimate">-4.0</td>
<td class="gt_row gt_center" headers="conf.low">-4.8, -3.2</td>
<td class="gt_row gt_center" headers="p.value">&lt;0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">Education</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;8th Grade</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;9 - 11th Grade</td>
<td class="gt_row gt_center" headers="estimate">-0.20</td>
<td class="gt_row gt_center" headers="conf.low">-1.0, 0.65</td>
<td class="gt_row gt_center" headers="p.value">0.6</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;High School</td>
<td class="gt_row gt_center" headers="estimate">0.01</td>
<td class="gt_row gt_center" headers="conf.low">-0.80, 0.82</td>
<td class="gt_row gt_center" headers="p.value">&gt;0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Some College</td>
<td class="gt_row gt_center" headers="estimate">-0.05</td>
<td class="gt_row gt_center" headers="conf.low">-0.83, 0.74</td>
<td class="gt_row gt_center" headers="p.value">&gt;0.9</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;College Grad</td>
<td class="gt_row gt_center" headers="estimate">-1.3</td>
<td class="gt_row gt_center" headers="conf.low">-2.1, -0.53</td>
<td class="gt_row gt_center" headers="p.value">0.001</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">MaritalStatus</td>
<td class="gt_row gt_center" headers="estimate"><br>
</td>
<td class="gt_row gt_center" headers="conf.low"><br>
</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Divorced</td>
<td class="gt_row gt_center" headers="estimate">—</td>
<td class="gt_row gt_center" headers="conf.low">—</td>
<td class="gt_row gt_center" headers="p.value"><br>
</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;LivePartner</td>
<td class="gt_row gt_center" headers="estimate">-1.2</td>
<td class="gt_row gt_center" headers="conf.low">-2.0, -0.31</td>
<td class="gt_row gt_center" headers="p.value">0.008</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Married</td>
<td class="gt_row gt_center" headers="estimate">-0.52</td>
<td class="gt_row gt_center" headers="conf.low">-1.1, 0.11</td>
<td class="gt_row gt_center" headers="p.value">0.11</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;NeverMarried</td>
<td class="gt_row gt_center" headers="estimate">-1.0</td>
<td class="gt_row gt_center" headers="conf.low">-1.8, -0.30</td>
<td class="gt_row gt_center" headers="p.value">0.006</td>
</tr>
<tr class="even">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Separated</td>
<td class="gt_row gt_center" headers="estimate">0.01</td>
<td class="gt_row gt_center" headers="conf.low">-1.2, 1.2</td>
<td class="gt_row gt_center" headers="p.value">&gt;0.9</td>
</tr>
<tr class="odd">
<td class="gt_row gt_left" headers="label">&nbsp;&nbsp;&nbsp;&nbsp;Widowed</td>
<td class="gt_row gt_center" headers="estimate">-0.89</td>
<td class="gt_row gt_center" headers="conf.low">-1.8, 0.03</td>
<td class="gt_row gt_center" headers="p.value">0.058</td>
</tr>
</tbody><tfoot class="gt_sourcenotes">
<tr class="odd">
<td colspan="4" class="gt_sourcenote">Abbreviation: CI = Confidence Interval</td>
</tr>
</tfoot>

</table>

</div>
</div>
</div>
<p>Un avantage de cette fonction est qu’elle affiche les modalités de référence <br> <br></p>
<section id="extraction-des-données-de-la-régression" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="extraction-des-données-de-la-régression"><span class="header-section-number">7.2.1</span> Extraction des données de la régression</h3>
<p>Pour extraire les coefficients, on utilise la commande <em>reg$coefficients</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>coefficients</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>              (Intercept)                Gendermale                       Age 
             31.246189483              -0.203258234               0.013282431 
            Race1Hispanic              Race1Mexican                Race1White 
             -1.727672872              -1.026818143              -2.185601993 
               Race1Other   Education9 - 11th Grade      EducationHigh School 
             -3.984048213              -0.197181112               0.009719181 
    EducationSome College     EducationCollege Grad  MaritalStatusLivePartner 
             -0.046028296              -1.330055594              -1.177454414 
     MaritalStatusMarried MaritalStatusNeverMarried    MaritalStatusSeparated 
             -0.515093942              -1.044402753               0.007168173 
     MaritalStatusWidowed 
             -0.891084986 </code></pre>
</div>
</div>
<p>Pour extraire les résidus, plusieurs options: <br> - utiliser la commande <em>reg$residuals</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>residuals[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="co"># ici je n'affiche que les 10 premiers pour ne pas encombrer le document</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          3          6          7          8          9         11 
 3.4164429  2.0820561 -0.5731473 -5.5028475 -4.6076547 -2.8323055 -4.2643776 
        12         14         15 
-1.8310198 -0.2502747 -3.3089004 </code></pre>
</div>
</div>
<ul>
<li>utiliser les fonctions <em>residuals()</em> ou <em>resid()</em></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">residuals</span>(reg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          3          6          7          8          9         11 
 3.4164429  2.0820561 -0.5731473 -5.5028475 -4.6076547 -2.8323055 -4.2643776 
        12         14         15 
-1.8310198 -0.2502747 -3.3089004 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">resid</span>(reg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>         1          3          6          7          8          9         11 
 3.4164429  2.0820561 -0.5731473 -5.5028475 -4.6076547 -2.8323055 -4.2643776 
        12         14         15 
-1.8310198 -0.2502747 -3.3089004 </code></pre>
</div>
</div>
<p>Pour extraire les valeurs prédites de chaque observation, comme pour les résidus, il y a 2 options: <br> - utiliser la commande <em>reg$fitted.values</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>reg<span class="sc">$</span>fitted.values[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        3        6        7        8        9       11       12 
28.80356 28.48794 27.81315 29.17285 28.29765 28.86231 30.48438 28.43102 
      14       15 
28.79027 29.14890 </code></pre>
</div>
</div>
<ul>
<li>utiliser les fonctions <em>fitted()</em> ou <em>fitted.values()</em></li>
</ul>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted</span>(reg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        3        6        7        8        9       11       12 
28.80356 28.48794 27.81315 29.17285 28.29765 28.86231 30.48438 28.43102 
      14       15 
28.79027 29.14890 </code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">fitted.values</span>(reg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        3        6        7        8        9       11       12 
28.80356 28.48794 27.81315 29.17285 28.29765 28.86231 30.48438 28.43102 
      14       15 
28.79027 29.14890 </code></pre>
</div>
</div>
<p>On peut obtenir un tableau avec le résumé des coefficients (estimation, écart-type p-value, t-test) avec la fonction <em>tidy()</em> du package <em>broom</em>. Les bornes de l’intervalle de confiance à 95% peuvent être ajoutées en utilisant l’argument <em>conf.int=TRUE</em>. Pour un autre niveau de confiance, on peut ajouter l’argument <em>conf.level = 0.99</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>tab_summary <span class="ot">&lt;-</span> <span class="fu">tidy</span>(reg, <span class="at">conf.int =</span> T)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(tab_summary)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 7
  term          estimate std.error statistic  p.value  conf.low conf.high
  &lt;chr&gt;            &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept)    31.2      0.650       48.1  0        30.0        32.5   
2 Gendermale     -0.203    0.183       -1.11 2.67e- 1 -0.562       0.155 
3 Age             0.0133   0.00644      2.06 3.92e- 2  0.000656    0.0259
4 Race1Hispanic  -1.73     0.436       -3.97 7.41e- 5 -2.58       -0.874 
5 Race1Mexican   -1.03     0.399       -2.57 1.02e- 2 -1.81       -0.244 
6 Race1White     -2.19     0.278       -7.86 4.74e-15 -2.73       -1.64  </code></pre>
</div>
</div>
</section>
<section id="données-manquantes" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="données-manquantes"><span class="header-section-number">7.2.2</span> Données manquantes</h3>
<p>Par défaut, la fonction <em>lm()</em> supprime les observations pour lesquelless il y a une donnée manquante pour au moins une des variables du modèle. <br> <br> Pour savoir combien d’observations ont été utilisées pour ajuster le modèle, on peut regarder la longueur du vecteur des résidus ou bien de celui des valeurs prédites</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(reg<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5416</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(reg<span class="sc">$</span>fitted.values)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5416</code></pre>
</div>
</div>
<p>Ainsi dans cet exemple, sur les 7832 observations de notre jeu de données, seulement 5416 ont des données complètes sur les variables considérées et sont donc prises en compte pour ajuster le modèle. <br> <br> La fonction <em>na.omit()</em> permet de ne garder que les observations qui n’ont aucune donnée manquante. Pour obtenir le tableau de données utilisé dans la régression, nous pouvons appliquer cette fonction à nos données en ne sélectionnant que les variables utilisées dans la régression</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>dataReg <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(NHANES <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(BMI,  Gender , Age, Race1, Education, MaritalStatus)))</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(dataReg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5416    6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dataReg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 6
    BMI Gender   Age Race1 Education      MaritalStatus
  &lt;dbl&gt; &lt;fct&gt;  &lt;int&gt; &lt;fct&gt; &lt;fct&gt;          &lt;fct&gt;        
1  32.2 male      34 White High School    Married      
2  30.6 female    49 White Some College   LivePartner  
3  27.2 female    45 White College Grad   Married      
4  23.7 male      66 White Some College   Married      
5  23.7 male      58 White College Grad   Divorced     
6  26.0 male      54 White 9 - 11th Grade Married      </code></pre>
</div>
</div>
</section>
<section id="visualisation-graphique-des-coefficients" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="visualisation-graphique-des-coefficients"><span class="header-section-number">7.2.3</span> Visualisation graphique des coefficients</h3>
<p>Pour visualiser graphiquement les coefficients de la régression, on peut réaliser un forestplot</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extraire les coefficients et les intervalles de confiance</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>tab_summary <span class="ot">&lt;-</span> <span class="fu">tidy</span>(reg, <span class="at">conf.int =</span> <span class="cn">TRUE</span>)</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_summary, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> term)) <span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Ajouter les points pour les coefficients</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># Ajouter les barres d'erreur pour les intervalles de confiance</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># Ajout de la ligne des 0</span></span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Coefficients"</span>, <span class="at">y =</span> <span class="st">"Estimation"</span>) <span class="sc">+</span>  </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="co"># Utiliser un thème minimaliste</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Même graphique sans l’intercept</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>tab_summary <span class="ot">&lt;-</span> <span class="fu">tidy</span>(reg, <span class="at">conf.int =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(term<span class="sc">!=</span><span class="st">"(Intercept)"</span>)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(tab_summary, <span class="fu">aes</span>(<span class="at">x =</span> estimate, <span class="at">y =</span> term)) <span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span>  <span class="co"># Ajouter les points pour les coefficients</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">xmin =</span> conf.low, <span class="at">xmax =</span> conf.high), <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span>  <span class="co"># Ajouter les barres d'erreur pour les intervalles de confiance</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span> <span class="co"># Ajout de la ligne des 0</span></span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Coefficients"</span>, <span class="at">y =</span> <span class="st">"Estimation"</span>) <span class="sc">+</span>  </span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()  <span class="co"># Utiliser un thème minimaliste</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Le package <em>ggstats</em> propose une fonction permettant d’obtenir un joli forrest plot : <em>ggcoef_model()</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ggstats<span class="sc">::</span><span class="fu">ggcoef_model</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>*Ressource : <a href="https://larmarange.github.io/ggstats/articles/ggcoef_model.html#quick-coefficients-plot">https://larmarange.github.io/ggstats/articles/ggcoef_model.html#quick-coefficients-plot</a></p>
</section>
<section id="modèles-emboités" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="modèles-emboités"><span class="header-section-number">7.2.4</span> Modèles emboités</h3>
<p>Considérons maintenant le même modèle de régression, auquel on ajoute la variable du revenu (<em>HHIncomeMid</em>).<br> Pour ce faire on peut utiliser la fonction <em>lm()</em> comme précédemment en ajoutant <em>HHIncomeMid</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>reg2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Race1 <span class="sc">+</span> Education <span class="sc">+</span> MaritalStatus <span class="sc">+</span> HHIncomeMid, <span class="at">data =</span> NHANES)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMI ~ Gender + Age + Race1 + Education + MaritalStatus + 
    HHIncomeMid, data = NHANES)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.174  -4.476  -1.053   3.219  51.643 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                3.196e+01  6.890e-01  46.380  &lt; 2e-16 ***
Gendermale                -1.075e-01  1.915e-01  -0.561 0.574550    
Age                        1.035e-02  6.749e-03   1.534 0.125026    
Race1Hispanic             -1.872e+00  4.676e-01  -4.005  6.3e-05 ***
Race1Mexican              -1.404e+00  4.262e-01  -3.294 0.000994 ***
Race1White                -2.373e+00  2.955e-01  -8.031  1.2e-15 ***
Race1Other                -4.136e+00  4.338e-01  -9.535  &lt; 2e-16 ***
Education9 - 11th Grade   -8.220e-02  4.646e-01  -0.177 0.859585    
EducationHigh School       1.893e-01  4.410e-01   0.429 0.667803    
EducationSome College      2.752e-01  4.350e-01   0.633 0.526981    
EducationCollege Grad     -9.353e-01  4.551e-01  -2.055 0.039912 *  
MaritalStatusLivePartner  -1.045e+00  4.705e-01  -2.220 0.026470 *  
MaritalStatusMarried      -3.412e-01  3.400e-01  -1.004 0.315645    
MaritalStatusNeverMarried -1.110e+00  3.967e-01  -2.799 0.005141 ** 
MaritalStatusSeparated     6.782e-03  6.666e-01   0.010 0.991883    
MaritalStatusWidowed      -9.150e-01  4.911e-01  -1.863 0.062501 .  
HHIncomeMid               -1.257e-05  3.363e-06  -3.738 0.000188 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.598 on 4939 degrees of freedom
  (2876 observations deleted due to missingness)
Multiple R-squared:  0.04232,   Adjusted R-squared:  0.03922 
F-statistic: 13.64 on 16 and 4939 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Une autre façon de faire est d’utiliser la fonction <em>update()</em>. Cette fonction permet d’ajouter une ou plusieurs variables à un modèle déjà ajusté. <br> <span class="math display">\[ \text{update (objet_ancien_model,  }.\sim. + \text{ nouvelle_var)}\]</span></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>reg2bis <span class="ot">&lt;-</span> <span class="fu">update</span>(reg, .<span class="sc">~</span>.<span class="sc">+</span>HHIncomeMid)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg2bis)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = BMI ~ Gender + Age + Race1 + Education + MaritalStatus + 
    HHIncomeMid, data = NHANES)

Residuals:
    Min      1Q  Median      3Q     Max 
-15.174  -4.476  -1.053   3.219  51.643 

Coefficients:
                            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                3.196e+01  6.890e-01  46.380  &lt; 2e-16 ***
Gendermale                -1.075e-01  1.915e-01  -0.561 0.574550    
Age                        1.035e-02  6.749e-03   1.534 0.125026    
Race1Hispanic             -1.872e+00  4.676e-01  -4.005  6.3e-05 ***
Race1Mexican              -1.404e+00  4.262e-01  -3.294 0.000994 ***
Race1White                -2.373e+00  2.955e-01  -8.031  1.2e-15 ***
Race1Other                -4.136e+00  4.338e-01  -9.535  &lt; 2e-16 ***
Education9 - 11th Grade   -8.220e-02  4.646e-01  -0.177 0.859585    
EducationHigh School       1.893e-01  4.410e-01   0.429 0.667803    
EducationSome College      2.752e-01  4.350e-01   0.633 0.526981    
EducationCollege Grad     -9.353e-01  4.551e-01  -2.055 0.039912 *  
MaritalStatusLivePartner  -1.045e+00  4.705e-01  -2.220 0.026470 *  
MaritalStatusMarried      -3.412e-01  3.400e-01  -1.004 0.315645    
MaritalStatusNeverMarried -1.110e+00  3.967e-01  -2.799 0.005141 ** 
MaritalStatusSeparated     6.782e-03  6.666e-01   0.010 0.991883    
MaritalStatusWidowed      -9.150e-01  4.911e-01  -1.863 0.062501 .  
HHIncomeMid               -1.257e-05  3.363e-06  -3.738 0.000188 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.598 on 4939 degrees of freedom
  (2876 observations deleted due to missingness)
Multiple R-squared:  0.04232,   Adjusted R-squared:  0.03922 
F-statistic: 13.64 on 16 and 4939 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Pour comparer deux modèles emboîtés, on peut réaliser une ANOVA. <br> <br> <b> Attention </b> Pour pouvoir comparer les modèles, ils doivent avoir été ajustés en utilisant les mêmes observations ! S’il y avait des données manquantes pour la nouvelle variable, le second modèle risque d’avoir été ajusté sur moins de données. Pour pouvoir comparer les modèles il faut donc réajuster la première régression sur les observations qui n’ont pas de données manquante pour <em>HHIncomeMid</em><br> <br> Nous allons utiliser la fonction <em>na.omit()</em> pour obtenir le dataset utilisé dans la deuxième régression. Nous pourrons ensuite réajuster le premier modèle sur ce nouveau dataset.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Récupérer uniquement les obseravtions utilisées pour ajuster le modèle</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>dataReg <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(NHANES <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(BMI,  Gender , Age, Race1, Education, MaritalStatus, HHIncomeMid)))</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Réajustement de la première régression sur ces données uniquement</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>reg_bis <span class="ot">&lt;-</span> <span class="fu">lm</span>(BMI <span class="sc">~</span> Gender <span class="sc">+</span> Age <span class="sc">+</span> Race1 <span class="sc">+</span> Education <span class="sc">+</span> MaritalStatus, <span class="at">data =</span> dataReg)</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Vérification</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="fu">length</span>(reg_bis<span class="sc">$</span>residuals)<span class="sc">==</span><span class="fu">length</span>(reg2bis<span class="sc">$</span>residuals)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
</div>
<p>Nous pouvons maintenant réalisé l’anova afin de savoir si l’ajout du revenu améliore significativement le modèle. Pour ce faire, nous utilisons la fonction <em>anova()</em> <br> <span class="math display">\[ \text{anova(modele1, modele2)}\]</span> avec modele1 le modele avec le moins de variables</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(reg_bis, reg2bis)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Analysis of Variance Table

Model 1: BMI ~ Gender + Age + Race1 + Education + MaritalStatus
Model 2: BMI ~ Gender + Age + Race1 + Education + MaritalStatus + HHIncomeMid
  Res.Df    RSS Df Sum of Sq     F    Pr(&gt;F)    
1   4940 215613                                 
2   4939 215005  1    608.16 13.97 0.0001878 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><em>Rappel :</em> L’anova teste H0: modèle 1 préféré VS H1: l’ajout de la variable améliore significativement le modèle</p>
</section>
<section id="qualité-de-la-régression" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="qualité-de-la-régression"><span class="header-section-number">7.2.5</span> Qualité de la régression</h3>
<p>La sortie de <em>summary(reg)</em> nous donne le R2 et le R2 ajusté. On peut accéder directement à ces valeurs en tant qu’élément de l’a’objet retourné par la fonction <em>summary()</em>, donc via le symbole “$”</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)<span class="sc">$</span>r.squared <span class="co">#R2</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03659117</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg)<span class="sc">$</span>adj.r.squared</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03391503</code></pre>
</div>
</div>
<p>La fonction <em>summary()</em> ne donne en revanche pas l’aic ni le bic du modèle. Pour les obtenir, on peut utiliser les fonction <em>AIC()</em> et <em>BIC()</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35832.71</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 35944.86</code></pre>
</div>
</div>
<p><em>Remarque :</em> Plus l’AIC / le BIC est faible, meilleur est le modèle <br> <br> <em>Remarque 2 :</em> On peut passer plusieurs modèles comme argument de ces fonctions. On obtient alors un dataset avec une ligne par modèle et deux colonnes (“df” correspondant au nombre de paramètre et “AIC”)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(reg_bis, reg2bis)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>        df      AIC
reg_bis 17 32796.95
reg2bis 18 32784.95</code></pre>
</div>
</div>
</section>
<section id="vérification-des-hypothèses" class="level3" data-number="7.2.6">
<h3 data-number="7.2.6" class="anchored" data-anchor-id="vérification-des-hypothèses"><span class="header-section-number">7.2.6</span> Vérification des hypothèses</h3>
<p>Il y a plusieurs façons de faire le diagnostique de la régression. Je vais présenté ici des façons manuelles et utiliser le package <em>olsrr</em>, mais d’autres packages existent. De plus, nous allons nous concentrer sur des analyses graphiques.</p>
<section id="homoscédasticité-et-linéarité" class="level4">
<h4 class="anchored" data-anchor-id="homoscédasticité-et-linéarité">Homoscédasticité et linéarité</h4>
<p>Pour vérifier l’homoscédasticité (constance de la variance des résidus), on peut faire un graphe des résidus (en général on préfère les résidus studentisés) en fonction des valeurs prédites <br> Ce graphique peut également permettre de déterminer si l’on a oublié une variable carrée, sinusoidale, etc en fonction de la forme/tendance que prennent les résidus. <br> <br> <em>Rappel :</em> S’il y a homoscedasticité, le nuage de point ne devrait pas avoir de tendance <br> <br> <em>Remarque :</em> On peut utiliser ce même graphique pour visualiser les outliers étant donné qu’ils sont définis en fonction de leur résidus studentisés. <br> <br> <em>Rappel 2 :</em> On peut obtenir les résidus avec les fonctions <em>residuals()</em> ou <em>resid()</em> ou la commande <em>reg$residuals</em> , les résidus studentisés avec la fonction <em>rstudent()</em> et les valeurs prédites avec la commande <em>reg.fitted</em> <br> <br> Avec ggplot2</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(reg<span class="sc">$</span>residuals)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(reg<span class="sc">$</span>coeff)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reg, <span class="fu">aes</span>(<span class="at">x=</span>.fitted, <span class="at">y=</span><span class="fu">rstudent</span>(reg)))<span class="sc">+</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p), <span class="at">col =</span> <span class="st">"red"</span>)<span class="sc">+</span> <span class="co"># 1 variable dans le modèle + l'intercept = length(reg$coeff) seuil haut pour déterminer les outliers</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p), <span class="at">col =</span> <span class="st">"red"</span>)<span class="sc">+</span> <span class="co"># seuil bas pour déterminer les outliers</span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Homoscédasticité et outliers"</span>, <span class="at">x =</span> <span class="st">"Fitted values"</span>, <span class="at">y =</span> <span class="st">"Studentized residuals"</span>)<span class="sc">+</span></span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Ramarque :</em> au lieu d’utiliser les quantiles de la loi de Student, on peut utiliser les approximations -2 et 2 comme seuil pour détecter les outliers. C’est le choix fait notamment par défaut dans le package <em>olsrr</em>. <br> <br> Avec olssr: le graphique des résidus n’affiche pas les lignes de seuils des outliers, il sert donc juste à verifié l’homoscédasticité. Il est donné par la fonction <em>ols_plot_resid_fit()</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_fit</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="normalité-des-résidus" class="level4">
<h4 class="anchored" data-anchor-id="normalité-des-résidus">Normalité des résidus</h4>
<p>Pour vérifier la normalité des résidus, on peut tracer leur qqplot. <br> <br> Avec ggplot</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">residuals =</span> <span class="fu">resid</span>(reg)), <span class="fu">aes</span>(<span class="at">sample =</span> <span class="fu">resid</span>(reg))) <span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_qq</span>() <span class="sc">+</span>  <span class="co"># Tracé des quantiles</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_qq_line</span>(<span class="at">col =</span> <span class="st">"red"</span>) <span class="sc">+</span>  <span class="co"># Ajout de la ligne de référence</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Normalité des résidus"</span>, <span class="at">x =</span> <span class="st">"Quantiles théoriques"</span>, <span class="at">y =</span> <span class="st">"Quantiles des résidus"</span>) <span class="sc">+</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Avec olsrr</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_qq</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-levier-et-outliers" class="level4">
<h4 class="anchored" data-anchor-id="observations-levier-et-outliers">Observations levier et outliers</h4>
<section id="outliers" class="level5">
<h5 class="anchored" data-anchor-id="outliers">Outliers</h5>
<p>Comme évoqué précédemment, pour visualisé les outliers, on peut utilisé le même graphe que pour l’hoscédasticité en ajoutant les lignes de seuil. <br> <br> <em>Rappel :</em> Les outliers sont les observations dans les résidus studentisés sont supérieurs ou inférieurs à deux valeurs seuil. <br> Les seuils sont les quantiles 0.975 d’une loi de Student de paramètre <span class="math inline">\((n, n-p-1)\)</span> et son inverse, avec <span class="math inline">\(n\)</span> le nombre d’observations ayant servi pour l’ajustement, et <span class="math inline">\(p\)</span> le nombre de paramètre (nombre de variables explicative + l’intercept) <br> Les seuils <span class="math inline">\(-2\)</span> et <span class="math inline">\(2\)</span> sont souvent utilisés comme approximation (c’est notamment le cas dans le package <em>olssr</em>). <br> <br> On peut obtenir les numéros de ligne des observations outliers en utilisant la fonction <em>which()</em>. Cette fonction prend en argument une condition sur un vecteur et renvoie les numéros des entrées vérifiant la condition.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(reg<span class="sc">$</span>residuals)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(reg<span class="sc">$</span>coeff)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 1.960403</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">rstudent</span>(reg)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p) <span class="sc">|</span> <span class="fu">rstudent</span>(reg)<span class="sc">&lt;</span> <span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  34   75   90  145  176  181  187  211  212  245  250  261  340  392  400  405 
  24   51   64  107  128  133  138  156  157  178  182  190  245  282  289  292 
 406  415  453  524  535  568  588  602  663  670  735  738  742  751  771  812 
 293  299  324  365  374  394  409  419  460  466  512  515  519  526  540  564 
 882  930  980  984  996  998 1013 1041 1069 1076 1080 1094 1118 1128 1139 1175 
 614  644  671  675  687  688  698  719  740  746  749  758  773  779  786  810 
1237 1256 1262 1264 1274 1364 1406 1469 1523 1534 1542 1560 1677 1714 1719 1728 
 853  863  867  869  875  937  964 1009 1046 1053 1058 1066 1141 1169 1174 1181 
1764 1780 1787 1813 1833 1838 1843 1883 1887 1898 1928 2055 2071 2079 2159 2176 
1203 1214 1219 1238 1253 1257 1262 1290 1293 1300 1323 1412 1423 1428 1491 1503 
2206 2215 2228 2263 2322 2367 2375 2409 2446 2472 2508 2528 2538 2603 2662 2704 
1521 1526 1536 1565 1607 1638 1644 1669 1697 1718 1737 1751 1757 1799 1840 1867 
2719 2758 2769 2857 2895 2929 2998 3083 3109 3126 3166 3168 3197 3207 3223 3255 
1875 1906 1913 1977 2000 2024 2069 2122 2140 2152 2180 2182 2198 2204 2218 2240 
3268 3361 3374 3427 3446 3473 3488 3504 3552 3558 3595 3599 3742 3743 3783 3806 
2251 2317 2326 2364 2377 2395 2404 2411 2440 2443 2470 2474 2579 2580 2611 2626 
3807 3832 3928 4026 4027 4059 4072 4087 4131 4133 4356 4438 4534 4572 4691 4692 
2627 2644 2704 2762 2763 2786 2798 2811 2847 2849 2998 3060 3124 3150 3240 3241 
4786 4787 4788 4949 4968 4969 5038 5039 5040 5060 5061 5102 5103 5166 5167 5175 
3293 3294 3295 3402 3416 3417 3464 3465 3466 3478 3479 3502 3503 3544 3545 3551 
5282 5307 5308 5314 5323 5352 5405 5430 5440 5470 5573 5580 5587 5591 5630 5646 
3620 3639 3640 3643 3650 3670 3716 3733 3741 3761 3835 3841 3845 3846 3870 3883 
5647 5648 5689 5706 5809 5836 5849 5853 5862 5884 5898 5906 5931 5932 5933 5966 
3884 3885 3916 3927 3993 4013 4023 4027 4031 4049 4061 4068 4089 4090 4091 4110 
6021 6063 6064 6117 6121 6122 6123 6238 6364 6373 6446 6459 6508 6520 6645 6683 
4149 4178 4179 4210 4214 4215 4216 4295 4384 4390 4443 4453 4487 4491 4579 4599 
6695 6860 6886 6887 6910 6911 6936 6945 6980 6997 7007 7021 7024 7048 7057 7062 
4608 4735 4754 4755 4770 4771 4787 4794 4821 4834 4836 4845 4846 4861 4863 4865 
7063 7084 7198 7289 7307 7335 7336 7337 7338 7509 7614 7626 7627 7628 7723 7724 
4866 4881 4961 5024 5038 5058 5059 5060 5061 5186 5267 5274 5275 5276 5334 5335 
7774 7803 
5373 5389 </code></pre>
</div>
</div>
<p>Si on veut savoir à quelles observations cela correspond, on peut filtrer le jeu de données sur ces observations avec la fonction <em>slice()</em> qui permet directement de filtrer sur les numéros de ligne. <br> <b> Attention :</b> Il faut filtrer le jeu de données qui a effectivement servi pour ajuster la régression, c’est à dire celui sans donnée manquante. Sinon les numéros de lignes ne correspondent pas.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> dataReg <span class="sc">%&gt;%</span> </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">which</span>(<span class="fu">rstudent</span>(reg)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p) <span class="sc">|</span> <span class="fu">rstudent</span>(reg)<span class="sc">&lt;</span> <span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
</section>
<section id="leviers" class="level5">
<h5 class="anchored" data-anchor-id="leviers">Leviers</h5>
<p>Pour obtenir les leviers de chaque observation, on utilise la fonction <em>hatvalues()</em> qui prend l’objet de régression en argument</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hatvalues</span>(reg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="co"># ici je n'affiche que les 10 premiers pour ne pas encombrer le document</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          1           3           6           7           8           9 
0.001695559 0.003236305 0.001023860 0.001285104 0.002943260 0.001958299 
         11          12          14          15 
0.003549380 0.001940784 0.001732438 0.001404735 </code></pre>
</div>
</div>
<p>Pour obtenir les observations qui peuvent être considérer comme levier, on peut utiliser la fonction <em>which()</em> et utiliser le seuil <em>2p/n</em>. Ceci est le seuil le plus souvent utilisé, il est notamment utilisé par défaut par le package <em>olsrr</em>. Pour être plus précis, on peut aussi différencier 2 cas : <br> - Si <span class="math inline">\(n-p&gt;12\)</span> et <span class="math inline">\(p&gt;6\)</span>, alors <span class="math inline">\(seuil = 3p/n\)</span> <br> - sinon <span class="math inline">\(seuil = 2p/n\)</span> <br> Rappel : n est le nombre d’observations dans le modèle et p est le nombre de paramètres (nombre de variables explicatives et intercept)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>seuil <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((n<span class="sc">-</span>p)<span class="sc">&gt;</span><span class="dv">12</span> <span class="sc">&amp;</span> p<span class="sc">&gt;</span><span class="dv">6</span>, <span class="dv">3</span><span class="sc">*</span>p<span class="sc">/</span>n, <span class="dv">2</span><span class="sc">*</span>p<span class="sc">/</span>n)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">hatvalues</span>(reg)<span class="sc">&gt;</span>seuil)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  22   84  178  183  195  497  574  587  737  846  933 1351 1383 1394 1409 1500 
  15   59  130  135  143  349  398  408  514  591  646  930  950  957  967 1029 
1523 1560 1601 1717 1907 1946 1992 2184 2276 2446 2512 2569 2609 2737 2828 2842 
1046 1066 1095 1172 1307 1338 1368 1507 1573 1697 1740 1776 1803 1890 1956 1966 
3000 3142 3348 3418 3508 3586 3599 3709 3710 3977 3980 4091 4662 5076 5077 5142 
2071 2164 2305 2358 2414 2465 2474 2555 2556 2735 2738 2814 3217 3483 3484 3530 
5199 5365 5524 5745 5852 5938 5987 6090 6198 6547 6603 6604 6647 6860 6871 6931 
3568 3682 3804 3949 4026 4093 4127 4196 4269 4513 4557 4558 4580 4735 4741 4783 
6992 7192 7222 7309 7312 7459 7463 7476 7773 7806 
4829 4958 4980 5040 5042 5144 5148 5160 5372 5392 </code></pre>
</div>
</div>
<p><br></p>
<p>Graphique des observations leviers avec ggplot2</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reg, <span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">hatvalues</span>(reg), <span class="at">y =</span> <span class="fu">rstudent</span>(reg)))<span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">xintercept =</span> <span class="dv">2</span><span class="sc">*</span>p<span class="sc">/</span>n, <span class="at">col =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Levier"</span>,</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Residus studentisés"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Le package <em>olsrr</em> permet d’obtenir un graphique avec les outliers et les observations leviers, ainsi que les numéros de ligne de ces observations en utilisant la fonction <em>ols_plot_resid_lev()</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_lev</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p><em>Remarque:</em> Dans cet exemple ce n’est pas très lisible car nous avons beaucoup de données, mais ce graphique est vraiment pratique quand il y a moins de données.</p>
</section>
<section id="observations-influentes" class="level5">
<h5 class="anchored" data-anchor-id="observations-influentes">Observations influentes</h5>
<p>On obtiens les observations influentes en regardant les distances de Cook. <br> Les distances de Cook sont données par la fonction <em>cook.distance()</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cooks.distance</span>(reg)[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>] <span class="co"># ici je n'affiche que les 10 premiers pour ne pas encombrer le document</span></span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>           1            3            6            7            8            9 
2.847096e-05 2.024495e-05 4.832033e-07 5.593676e-05 9.011885e-05 2.261147e-05 
          11           12           14           15 
9.320071e-05 9.365212e-06 1.561222e-07 2.211311e-05 </code></pre>
</div>
</div>
<p>Il existe plusieurs seuils pour considérer qu’une observation est influente : - distance de Cook supérieure au quantile 95% de la loi de Fisher(p,n-p) avec <span class="math inline">\(n\)</span> le nombre d’observations dans le modèle et <span class="math inline">\(p\)</span> le nombre de paramètres. ce seuil est statistiquement robuste, mais il peut être trop conservateur quand il y a beaucoup d’observations <br> - distance de Cook supérieure à <span class="math inline">\(4/n\)</span> (seuil par défaut dans olsrr) ou <span class="math inline">\(4/(n-k-1)\)</span> avec <span class="math inline">\(k\)</span> nombre de variables expplicatives (<span class="math inline">\(k=p-1\)</span>) (la version <span class="math inline">\(n-k-1\)</span> est à préférer s’il y a beaucoup de variables explicatives) - distance de Cook supérieure à <span class="math inline">\(1/n\)</span> ou <span class="math inline">\(1/(n-k-1)\)</span> - distance de Cook supérieure à 1 <br> <br> Pour obtenir les observations influentes (pour un seuil donné), on peut de nouveau utiliser la fonction <em>which()</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>seuil <span class="ot">=</span> <span class="fu">qf</span>(<span class="fl">0.95</span>, p,n<span class="sc">-</span>p)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">cooks.distance</span>(reg)<span class="sc">&gt;</span>seuil)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>named integer(0)</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>seuil <span class="ot">=</span> <span class="dv">4</span><span class="sc">/</span>n</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">which</span>(<span class="fu">cooks.distance</span>(reg)<span class="sc">&gt;</span>seuil)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  34   75   88   90  145  161  176  211  212  245  261  340  392  400  405  406 
  24   51   63   64  107  118  128  156  157  178  190  245  282  289  292  293 
 415  453  497  524  535  568  588  602  670  735  738  742  763  771  812  882 
 299  324  349  365  374  394  409  419  466  512  515  519  535  540  564  614 
 919  930  959  984  998 1013 1041 1069 1076 1080 1094 1128 1139 1157 1175 1215 
 636  644  656  675  688  698  719  740  746  749  758  779  786  799  810  837 
1227 1256 1262 1264 1274 1291 1351 1364 1394 1409 1469 1523 1540 1542 1560 1602 
 845  863  867  869  875  888  930  937  957  967 1009 1046 1057 1058 1066 1096 
1706 1714 1764 1774 1780 1784 1787 1813 1833 1838 1846 1883 1887 1948 1974 1985 
1163 1169 1203 1209 1214 1217 1219 1238 1253 1257 1264 1290 1293 1339 1360 1363 
2040 2068 2071 2159 2206 2241 2263 2322 2329 2341 2367 2375 2409 2432 2446 2448 
1400 1422 1423 1491 1521 1545 1565 1607 1613 1620 1638 1644 1669 1687 1697 1699 
2485 2505 2507 2508 2522 2528 2538 2576 2583 2603 2609 2704 2719 2769 2828 2857 
1725 1734 1736 1737 1746 1751 1757 1780 1786 1799 1803 1867 1875 1913 1956 1977 
2888 2895 2929 2991 2998 3000 3027 3109 3126 3151 3166 3168 3207 3223 3255 3268 
1994 2000 2024 2064 2069 2071 2090 2140 2152 2169 2180 2182 2204 2218 2240 2251 
3274 3287 3374 3418 3427 3441 3446 3504 3508 3552 3558 3559 3599 3667 3783 3786 
2257 2268 2326 2358 2364 2375 2377 2411 2414 2440 2443 2444 2474 2522 2611 2613 
3787 3788 3832 3928 4026 4027 4059 4072 4087 4094 4095 4133 4248 4356 4403 4418 
2614 2615 2644 2704 2762 2763 2786 2798 2811 2817 2818 2849 2931 2998 3035 3046 
4438 4505 4510 4534 4548 4572 4662 4691 4692 4786 4787 4788 4914 4919 4949 4968 
3060 3103 3105 3124 3131 3150 3217 3240 3241 3293 3294 3295 3377 3381 3402 3416 
4969 5038 5039 5040 5047 5060 5061 5102 5103 5166 5167 5175 5207 5208 5282 5314 
3417 3464 3465 3466 3470 3478 3479 3502 3503 3544 3545 3551 3573 3574 3620 3643 
5323 5352 5405 5430 5440 5580 5587 5591 5630 5646 5647 5648 5706 5836 5849 5853 
3650 3670 3716 3733 3741 3841 3845 3846 3870 3883 3884 3885 3927 4013 4023 4027 
5862 5884 5886 5898 5906 5932 5933 5966 6021 6063 6064 6113 6114 6117 6198 6238 
4031 4049 4051 4061 4068 4090 4091 4110 4149 4178 4179 4207 4208 4210 4269 4295 
6373 6446 6459 6520 6575 6645 6683 6695 6860 6871 6886 6887 6910 6911 6936 6945 
4390 4443 4453 4491 4537 4579 4599 4608 4735 4741 4754 4755 4770 4771 4787 4794 
6956 6997 7007 7021 7024 7048 7057 7084 7175 7198 7289 7307 7419 7463 7509 7774 
4803 4834 4836 4845 4846 4861 4863 4881 4945 4961 5024 5038 5114 5148 5186 5373 
7803 
5389 </code></pre>
</div>
</div>
<p>Cet exemple illustre que le seuil choisi peut largement changer le nombre d’observations considérées comme influentes <br> <br></p>
<p>Graphique des distances de Cook<br> Avec ggplot2 (une version possible)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(reg, <span class="fu">aes</span>(<span class="fu">seq_along</span>(.cooksd), .cooksd))<span class="sc">+</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>, <span class="at">position=</span><span class="st">"identity"</span>)<span class="sc">+</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="dv">4</span><span class="sc">/</span>n, <span class="at">col =</span> <span class="st">"red"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Avec olsrr, on utilise la fonction <em>ols_plot_cooksd_chart()</em> avec en argument l’objet de la régression. On peut choisir la méthode utilisée pour le seuil avec l’argument <em>type = </em> (regarder dans la documentation les numéros des différentes méthodes). Si on préfère rentrer le seuil à la main, on peut le faire avec l’argument <em>threshold =</em>.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_cooksd_chart</span>(reg,<span class="at">type =</span> <span class="dv">1</span>, <span class="at">threshold =</span> <span class="cn">NULL</span>, <span class="at">print_plot =</span> <span class="cn">TRUE</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="observations-problématiques" class="level5">
<h5 class="anchored" data-anchor-id="observations-problématiques">Observations problématiques</h5>
<p>Les observations problématiques sont celles qui sont outlier ou levier et qui sont en plus influentes.<br> <br> Pour obtenir ces observations, on peut utiliser la fonction <em>intersect()</em> appliquée aux vecteurs de ces trois types d’observations</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">length</span>(reg<span class="sc">$</span>residuals)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">length</span>(reg<span class="sc">$</span>coeff)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>outliers <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">rstudent</span>(reg)<span class="sc">&gt;</span><span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p) <span class="sc">|</span> <span class="fu">rstudent</span>(reg)<span class="sc">&lt;</span> <span class="sc">-</span><span class="fu">qt</span>(<span class="fl">0.975</span>, n<span class="dv">-1</span><span class="sc">-</span>p))</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a>seuil <span class="ot">&lt;-</span> <span class="fu">ifelse</span>((n<span class="sc">-</span>p)<span class="sc">&gt;</span><span class="dv">12</span> <span class="sc">&amp;</span> p<span class="sc">&gt;</span><span class="dv">6</span>, <span class="dv">3</span><span class="sc">*</span>p<span class="sc">/</span>n, <span class="dv">2</span><span class="sc">*</span>p<span class="sc">/</span>n)</span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>leviers <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">hatvalues</span>(reg)<span class="sc">&gt;</span>seuil) </span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>seuil <span class="ot">=</span> <span class="dv">4</span><span class="sc">/</span>n</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>influentes <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cooks.distance</span>(reg)<span class="sc">&gt;</span>seuil)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="fu">intersect</span>(influentes, <span class="fu">c</span>(outliers,leviers))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1]   24   51   64  107  128  156  157  178  190  245  282  289  292  293  299
 [16]  324  349  365  374  394  409  419  466  512  515  519  540  564  614  644
 [31]  675  688  698  719  740  746  749  758  779  786  810  863  867  869  875
 [46]  930  937  957  967 1009 1046 1058 1066 1169 1203 1214 1219 1238 1253 1257
 [61] 1290 1293 1423 1491 1521 1565 1607 1638 1644 1669 1697 1737 1751 1757 1799
 [76] 1803 1867 1875 1913 1956 1977 2000 2024 2069 2071 2140 2152 2180 2182 2204
 [91] 2218 2240 2251 2326 2358 2364 2377 2411 2414 2440 2443 2474 2611 2644 2704
[106] 2762 2763 2786 2798 2811 2849 2998 3060 3124 3150 3217 3240 3241 3293 3294
[121] 3295 3402 3416 3417 3464 3465 3466 3478 3479 3502 3503 3544 3545 3551 3620
[136] 3643 3650 3670 3716 3733 3741 3841 3845 3846 3870 3883 3884 3885 3927 4013
[151] 4023 4027 4031 4049 4061 4068 4090 4091 4110 4149 4178 4179 4210 4269 4295
[166] 4390 4443 4453 4491 4579 4599 4608 4735 4741 4754 4755 4770 4771 4787 4794
[181] 4834 4836 4845 4846 4861 4863 4881 4961 5024 5038 5148 5186 5373 5389</code></pre>
</div>
</div>
<p><b> Attention : </b> Il s’agit des numéros de ligne dans le data sans donnée manquante (obtenu avec <em>na.omit()</em>), ils ne correspondent donc pas forcément aux numéros de lignes dans le dataset que vous avez donner en argument de la fonction <em>lm()</em> ! <br> <br> Voici comment obtenir les observations problématiques du premier model (<em>reg</em>):</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># D'abord on ne garde que les données utilisées pour ajuster le modèle</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>dataReg <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(NHANES <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">c</span>(BMI,  Gender , Age, Race1, Education, MaritalStatus)))</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensuite on filtre les observations via leur numéro de ligne</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>DataPb <span class="ot">&lt;-</span> dataReg <span class="sc">%&gt;%</span> </span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice</span>(<span class="fu">intersect</span>(influentes, <span class="fu">c</span>(outliers,leviers)))</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Dimensions</span></span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(DataPb)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 194   6</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Premières observations problématiques</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kable</span>(<span class="fu">head</span>(DataPb))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<table class="caption-top table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: right;">BMI</th>
<th style="text-align: left;">Gender</th>
<th style="text-align: right;">Age</th>
<th style="text-align: left;">Race1</th>
<th style="text-align: left;">Education</th>
<th style="text-align: left;">MaritalStatus</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: right;">46.69</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">28</td>
<td style="text-align: left;">Black</td>
<td style="text-align: left;">High School</td>
<td style="text-align: left;">NeverMarried</td>
</tr>
<tr class="even">
<td style="text-align: right;">40.70</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">50</td>
<td style="text-align: left;">Other</td>
<td style="text-align: left;">High School</td>
<td style="text-align: left;">Married</td>
</tr>
<tr class="odd">
<td style="text-align: right;">48.91</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">31</td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">College Grad</td>
<td style="text-align: left;">NeverMarried</td>
</tr>
<tr class="even">
<td style="text-align: right;">51.33</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">68</td>
<td style="text-align: left;">Black</td>
<td style="text-align: left;">9 - 11th Grade</td>
<td style="text-align: left;">Widowed</td>
</tr>
<tr class="odd">
<td style="text-align: right;">48.22</td>
<td style="text-align: left;">male</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">8th Grade</td>
<td style="text-align: left;">Married</td>
</tr>
<tr class="even">
<td style="text-align: right;">41.79</td>
<td style="text-align: left;">female</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">White</td>
<td style="text-align: left;">Some College</td>
<td style="text-align: left;">Widowed</td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
<section id="colinéarité" class="level4">
<h4 class="anchored" data-anchor-id="colinéarité">Colinéarité</h4>
<p>Pour détecter un problème de colinéarité des variables explicatives, on peut regarder le facteur d’inflation de la variance (VIF) qui mesure l’inflation de la variance des paramètres estimés, due à la multicollinéarité entre les variable explicative. <br> Un VIF = 1 signifie qu’il n’y a pas de corrélation entre la variable considérée et les autres et donc la variance du coefficient n’est pas augmentée. Un VIF supérieur à 5 indique un problème de corrélation et un VIF supérieur à 10 indique un problème très important. <br> <br> On peut obtenir les VIF avec la fonction <em>ols_vif_tol()</em> du package <em>olsrr</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_vif_tol</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   Variables Tolerance      VIF
1                 Gendermale 0.9624750 1.038988
2                        Age 0.6544262 1.528056
3              Race1Hispanic 0.6960117 1.436757
4               Race1Mexican 0.5776379 1.731188
5                 Race1White 0.4432034 2.256300
6                 Race1Other 0.6508998 1.536335
7    Education9 - 11th Grade 0.3834519 2.607889
8       EducationHigh School 0.2904722 3.442670
9      EducationSome College 0.2344217 4.265817
10     EducationCollege Grad 0.2380133 4.201445
11  MaritalStatusLivePartner 0.5564523 1.797099
12      MaritalStatusMarried 0.3151684 3.172907
13 MaritalStatusNeverMarried 0.3626850 2.757214
14    MaritalStatusSeparated 0.7835570 1.276231
15      MaritalStatusWidowed 0.5670643 1.763468</code></pre>
</div>
</div>
<p>Cette fonction donne le VIF de chaque modalité. <br> <br></p>
<p>Une façon d’obtenir les VIF par variable et non par modalité, est d’utiliser la fonction <em>vif()</em> du package <em>car</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(reg)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  GVIF Df GVIF^(1/(2*Df))
Gender        1.038988  1        1.019308
Age           1.528056  1        1.236146
Race1         1.322326  4        1.035541
Education     1.290620  4        1.032404
MaritalStatus 1.639081  5        1.050655</code></pre>
</div>
</div>
<p>Cette méthode est à privilégiée <br> <br></p>
<p>Regardons les VIF de la deuxième régression (celle avec le revenu)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(reg2)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  GVIF Df GVIF^(1/(2*Df))
Gender        1.043409  1        1.021474
Age           1.527128  1        1.235770
Race1         1.291975  4        1.032540
Education     1.500259  4        1.052012
MaritalStatus 1.769873  5        1.058752
HHIncomeMid   1.395653  1        1.181378</code></pre>
</div>
</div>
<p>Dans les deux cas il n’y a pas l’air d’y avoir de problème de multicolinéarité</p>
</section>
<section id="package-olssr" class="level4">
<h4 class="anchored" data-anchor-id="package-olssr">Package olssr</h4>
<p>Remarque générale sur le package <em>olssr</em>: les graphiques de ce package sont faits avec ggplot2. Cela permet de pouvoir facilement y apporter quelques modifications sur le thème, la personnalisation des axes, etc …<br> <br> Exemple de personnalisation du qqplot des résidus obtenu avec <em>olssr</em></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ols_plot_resid_qq</span>(reg)<span class="sc">+</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>()<span class="sc">+</span></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Quantiles theoriques"</span>,</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">"Quantiles observés"</span>, </span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">"QQplot des résidus"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="5.RegressionLineaire_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="ressources" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="ressources"><span class="header-section-number">7.3</span> Ressources</h2>
<p>Vérification des hypothèses : <br> - <a href="https://matthwilhelm.github.io/ProbaStat/R%C3%A9gr%C3%A9ssion_lin%C3%A9aire/hypotheses_et_diagnostics.html#homoscedasticite-variance-constante">cours théorique de l’EPFL</a> <br> - <a href="https://bookdown.org/teodor_tiplica/book_linearrrgression/ValidModel.html">Bookdown de Teodor Tiplica</a> Cours de régression linéaire avec R - mélange de la théorie et de la pratique <br> - <a href="http://www.sthda.com/english/articles/39-regression-model-diagnostics/161-linear-regression-assumptions-and-diagnostics-in-r-essentials/">STHDA</a> tutoriel sur le diagnostique de régression linéaire en R <br> <br> Package <em>olssr</em> : <a href="https://cran.r-project.org/web/packages/olsrr/index.html">lien vers la documentation</a> les différentes vignettes proposent des exemples <br> <br> <a href="https://danielrivera1.shinyapps.io/Regression2/">Didactic modeling process: Linear regression by Oscar Daniel Rivera Baena</a> Application R Shiny comme tutoriel sur la régression linéaire avec R</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./4.PremieresAnalyses.sur.R.html" class="pagination-link" aria-label="Analyses Bivariées">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Analyses Bivariées</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./6.RegressionLogistique.html" class="pagination-link" aria-label="Regression Logistique">
        <span class="nav-page-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Regression Logistique</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->




</body></html>